/*!
 * vue-pups v0.0.0
 * © 2021-~ ieujen
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).vuePups={},e.Vue)}(this,(function(e,t){"use strict";function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function o(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach((function(t){u(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=(e,t)=>{for(const[n,o]of t)e[n]=o;return e};var s=l(t.defineComponent({name:"vue-poups",props:{list:{type:Map,default:function(){return new Map}},zIndex:{type:Number,default:2e3},maskClickable:{type:Boolean,default:!0},transitionName:{type:String,default:"vp-bounce"},boxStyle:{type:Object,default:function(){return{}}}},setup:function(e){}}),[["render",function(e,n,o,r,i,a){return t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.list,(function(n){return t.openBlock(),t.createBlock(t.resolveDynamicComponent(n[1]),{key:n[0],"z-index":e.zIndex,maskClickable:e.maskClickable,transitionName:e.transitionName,style:t.normalizeStyle(e.boxStyle)},null,8,["z-index","maskClickable","transitionName","style"])})),128)}]]);var c=l(t.defineComponent({name:"popup-box",props:{zIndex:{type:Number,default:2e3},maskClickable:{type:Boolean,default:!0},transitionName:{type:String,default:"vp-bounce"},style:{type:Object,default:function(){return{}}}},emits:["remove"],setup:function(e,n){var o=n.emit,r=t.ref(!1),i=t.ref(null);t.onMounted((function(){t.nextTick((function(){r.value=!0}))}));return{show:r,animationEnd:function(){o("remove",i.value)},toClose:function(e){r.value=!1,i.value=e}}}}),[["render",function(e,n,o,r,i,a){return t.openBlock(),t.createElementBlock("div",{class:"vue_poups_box",style:t.normalizeStyle(e.style)},[t.createVNode(t.Transition,{name:"vp-fade"},{default:t.withCtx((function(){return[t.withDirectives(t.createElementVNode("div",{class:"vue_poups_box-mask",style:t.normalizeStyle({zIndex:e.zIndex}),onClick:n[0]||(n[0]=function(t){return e.maskClickable&&e.toClose("close")})},null,4),[[t.vShow,e.show]])]})),_:1}),t.createVNode(t.Transition,{name:e.transitionName,onAfterLeave:e.animationEnd},{default:t.withCtx((function(){return[t.withDirectives(t.createElementVNode("div",{class:"vue_poups_box-slot",style:t.normalizeStyle({zIndex:e.zIndex})},[t.renderSlot(e.$slots,"default",{toClose:e.toClose})],4),[[t.vShow,e.show]])]})),_:3},8,["name","onAfterLeave"])],4)}]]),f=new(function(){function e(){r(this,e)}return a(e,[{key:"onShow",value:function(){document.body.style.overflow="hidden"}},{key:"onHide",value:function(){document.body.style.overflow=""}},{key:"onDepthSet",value:function(e){}}]),e}()),p=t.reactive({list:new Map,zIndex:2e3,maskClickable:!0,transitionName:"vp-bounce",boxStyle:{}}),d=function(){function e(){r(this,e)}return a(e,[{key:"zIndex",get:function(){return p.zIndex},set:function(e){f.onDepthSet(e),p.zIndex=e}},{key:"clickable",get:function(){return p.maskClickable},set:function(e){p.maskClickable=e}},{key:"transitionName",get:function(){return p.transitionName},set:function(e){p.transitionName=e}},{key:"boxStyle",get:function(){return p.boxStyle},set:function(e){p.boxStyle=e}}]),e}(),y=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"vue-poups";r(this,e),this._appId=n,this._instances=t,this.toggleListener=f,this.style=new d,this._init()}return a(e,[{key:"_init",value:function(){var e=document.getElementById(this._appId);e&&(console.warn('document element "#'.concat(this._appId,'" has already been exists')),e.remove());var n=document.createElement("div");n.setAttribute("id",this._appId),document.body.appendChild(n),this._app=t.createApp({render:function(){return t.h(s,o({},p))}}),this._app.mount("#".concat(this._appId))}},{key:"show",value:function(e,n){var r=this;this.toggleListener.onShow();var i=this._instances[e];if(!i)throw new Error("不存在的实例名: ".concat(e));return new Promise((function(e){var a=Math.random().toString(36).substr(3)+Date.now().toString(16).substr(4),u={onRemove:function(t){r.toggleListener.onHide(),p.list.delete(a),e(t)}},l={default:function(e){var r=e.toClose,a=o(o({},n),{},{onClose:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"close";return r(e)}}),u=i.__scopeId;return u&&(a[u]=""),t.h(i,a)}},s=t.h(c,u,l);p.list.set(a,s)}))}},{key:"clear",value:function(){this.toggleListener.onHide(),p.list.clear()}},{key:"use",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return this._app.use(e,n)}}]),e}();e.VPups=y,Object.defineProperty(e,"__esModule",{value:!0}),e[Symbol.toStringTag]="Module"}));
