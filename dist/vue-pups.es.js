/*!
 * vue-pups v0.0.0
 * © 2021-~ ieujen
 */

import{defineComponent as e,openBlock as t,createElementBlock as n,Fragment as o,renderList as r,createBlock as i,resolveDynamicComponent as a,normalizeStyle as u,ref as l,onMounted as s,nextTick as c,createVNode as f,Transition as p,withCtx as d,withDirectives as y,createElementVNode as b,vShow as v,renderSlot as m,reactive as h,createApp as k,h as g}from"vue";function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function C(e,t,n){return t&&O(e.prototype,t),n&&O(e,n),e}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=(e,t)=>{for(const[n,o]of t)e[n]=o;return e};var j=S(e({name:"vue-poups",props:{list:{type:Map,default:function(){return new Map}},zIndex:{type:Number,default:2e3},maskClickable:{type:Boolean,default:!0},transitionName:{type:String,default:"vp-bounce"},boxStyle:{type:Object,default:function(){return{}}}},setup:function(e){}}),[["render",function(e,l,s,c,f,p){return t(!0),n(o,null,r(e.list,(function(n){return t(),i(a(n[1]),{key:n[0],"z-index":e.zIndex,maskClickable:e.maskClickable,transitionName:e.transitionName,style:u(e.boxStyle)},null,8,["z-index","maskClickable","transitionName","style"])})),128)}]]);var z=S(e({name:"popup-box",props:{zIndex:{type:Number,default:2e3},maskClickable:{type:Boolean,default:!0},transitionName:{type:String,default:"vp-bounce"},style:{type:Object,default:function(){return{}}}},emits:["remove"],setup:function(e,t){var n=t.emit,o=l(!1),r=l(null);s((function(){c((function(){o.value=!0}))}));return{show:o,animationEnd:function(){n("remove",r.value)},toClose:function(e){o.value=!1,r.value=e}}}}),[["render",function(e,o,r,i,a,l){return t(),n("div",{class:"vue_poups_box",style:u(e.style)},[f(p,{name:"vp-fade"},{default:d((function(){return[y(b("div",{class:"vue_poups_box-mask",style:u({zIndex:e.zIndex}),onClick:o[0]||(o[0]=function(t){return e.maskClickable&&e.toClose("close")})},null,4),[[v,e.show]])]})),_:1}),f(p,{name:e.transitionName,onAfterLeave:e.animationEnd},{default:d((function(){return[y(b("div",{class:"vue_poups_box-slot",style:u({zIndex:e.zIndex})},[m(e.$slots,"default",{toClose:e.toClose})],4),[[v,e.show]])]})),_:3},8,["name","onAfterLeave"])],4)}]]),N=new(function(){function e(){_(this,e)}return C(e,[{key:"onShow",value:function(){document.body.style.overflow="hidden"}},{key:"onHide",value:function(){document.body.style.overflow=""}},{key:"onDepthSet",value:function(e){}}]),e}()),P=h({list:new Map,zIndex:2e3,maskClickable:!0,transitionName:"vp-bounce",boxStyle:{}}),E=function(){function e(){_(this,e)}return C(e,[{key:"zIndex",get:function(){return P.zIndex},set:function(e){N.onDepthSet(e),P.zIndex=e}},{key:"clickable",get:function(){return P.maskClickable},set:function(e){P.maskClickable=e}},{key:"transitionName",get:function(){return P.transitionName},set:function(e){P.transitionName=e}},{key:"boxStyle",get:function(){return P.boxStyle},set:function(e){P.boxStyle=e}}]),e}(),D=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"vue-poups";_(this,e),this._appId=n,this._instances=t,this.toggleListener=N,this.style=new E,this._init()}return C(e,[{key:"_init",value:function(){var e=document.getElementById(this._appId);e&&(console.warn('document element "#'.concat(this._appId,'" has already been exists')),e.remove());var t=document.createElement("div");t.setAttribute("id",this._appId),document.body.appendChild(t),this._app=k({render:function(){return g(j,x({},P))}}),this._app.mount("#".concat(this._appId))}},{key:"show",value:function(e,t){var n=this;this.toggleListener.onShow();var o=this._instances[e];if(!o)throw new Error("不存在的实例名: ".concat(e));return new Promise((function(e){var r=Math.random().toString(36).substr(3)+Date.now().toString(16).substr(4),i={default:function(e){var n=e.toClose,r=x(x({},t),{},{onClose:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"close";return n(e)}}),i=o.__scopeId;return i&&(r[i]=""),g(o,r)}},a=g(z,{onRemove:function(t){n.toggleListener.onHide(),P.list.delete(r),e(t)}},i);P.list.set(r,a)}))}},{key:"clear",value:function(){this.toggleListener.onHide(),P.list.clear()}},{key:"use",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return this._app.use(e,n)}}]),e}();export{D as VPups};
